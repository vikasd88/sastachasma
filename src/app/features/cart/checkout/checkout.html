<div class="checkout-container">
  <h2>Checkout</h2>

  @if (cartItems.length > 0) {
    <div class="checkout-content-wrapper">
      <div class="checkout-left-column">
        <div class="order-summary">
          <h3>Order Summary</h3>
          @for (item of cartItems; track item.id) {
            <div class="cart-item">
              <img [src]="item.sanitizedImageUrl" [alt]="item.frame.name + ' - ' + item.lens.type" class="cart-item-image">
              <div class="item-details">
                <h4>{{ item.frame.name }} ({{ item.lens.type }} {{ item.power }} Diopters)</h4>
                <p>Frame Price: ₹{{ item.frame.price | number:'1.2-2' }}</p>
                <p>Lens Price: ₹{{ item.lens.price | number:'1.2-2' }}</p>
                <p>Quantity: {{ item.quantity }}</p>
                <p>Item Total: ₹{{ item.totalPrice | number:'1.2-2' }}</p>
              </div>
            </div>
          }
          <div class="totals">
            <p>Subtotal: ₹{{ subtotal | number:'1.2-2' }}</p>
            <p>Tax ({{ taxRate | percent }}) : ₹{{ taxAmount | number:'1.2-2' }}</p>
            <p>Other Charges: ₹{{ otherCharges | number:'1.2-2' }}</p>
            <h3>Total: ₹{{ totalAmount | number:'1.2-2' }}</h3>
          </div>
        </div>
      </div>

      <div class="checkout-right-column">
        <form (ngSubmit)="submitOrder()" class="checkout-form">
          <h3>Customer Details</h3>
          <div class="form-group">
            <label for="name">Name:</label>
            <input id="name" type="text" [(ngModel)]="customer.name" name="name" required>
          </div>
          <div class="form-group">
            <label for="email">Email:</label>
            <input id="email" type="email" [(ngModel)]="customer.email" name="email" required>
          </div>

          <h3>Delivery Address</h3>
          <div class="form-group">
            <label for="street">Street:</label>
            <input id="street" type="text" [(ngModel)]="deliveryAddress.street" name="street" required>
          </div>
          <div class="form-group">
            <label for="city">City:</label>
            <input id="city" type="text" [(ngModel)]="deliveryAddress.city" name="city" required>
          </div>
          <div class="form-group">
            <label for="state">State:</label>
            <input id="state" type="text" [(ngModel)]="deliveryAddress.state" name="state" required>
          </div>
          <div class="form-group">
            <label for="zip">Zip Code:</label>
            <input id="zip" type="text" [(ngModel)]="deliveryAddress.zip" name="zip" required>
          </div>

          <button type="submit" [disabled]="!customer.name || !customer.email || !deliveryAddress.street || !deliveryAddress.city || !deliveryAddress.state || !deliveryAddress.zip">Place Order</button>
        </form>
      </div>
    </div>
  } @else {
    <p>Your cart is empty. Please add items before proceeding to checkout.</p>
    <button (click)="router.navigate(['/'])">Continue Shopping</button>
  }
</div>
